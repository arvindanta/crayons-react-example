!function(){"use strict";function e(){try{return window.self!==window.top}catch(e){return!0}}var n=window.MFEController=window.MFEController||function(){var n={},o={},i=function(e){var n,o,i,r,a,d=void 0===e?{action:{type:"",sender:"",receiver:""},payload:null,broadcast:!1,targetOrigin:"",senderOrigin:window.origin}:e,c=d.action,l=c.type,s=void 0===l?"":l,u=c.sender,v=void 0===u?"":u,p=c.receiver,f=void 0===p?"":p,g=d.payload,y=void 0===g?null:g,b=d.broadcast,w=void 0!==b&&b,m=d.targetOrigin,h=void 0===m?"":m,_=d.senderOrigin,O=void 0===_?window.origin:_,E=document.querySelector('[app-id="'+f+'"]'),C=null===(n=E)||void 0===n?void 0:n.iframe;if(console.log("is iframe",C),console.log("sendmessage to "+f),C){var j=null===(r=null===(i=null!==(o=null==E?void 0:E.shadowRoot)&&void 0!==o?o:E)||void 0===i?void 0:i.querySelector(".mfe__container"))||void 0===r?void 0:r.querySelector("iframe");null===(a=null==j?void 0:j.contentWindow)||void 0===a||a.postMessage({action:{type:s,sender:v,receiver:f},payload:y,senderOrigin:O},h||"*")}else null==t||t({action:{type:s,sender:v,receiver:f},payload:y,broadcast:w})},t=function(e){var n=void 0===e?{action:{type:"",sender:"",receiver:""},payload:null,broadcast:!1}:e,i=n.action,t=i.type,r=void 0===t?"":t,a=i.sender,d=void 0===a?"":a,c=i.receiver,l=void 0===c?"":c,s=n.payload,u=void 0===s?null:s,v=n.broadcast;if(void 0!==v&&v){var p=Object.keys(o).filter((function(e){return e!==d}));p.forEach((function(e){var n=o[e],i={type:r,sender:d,receiver:e};n.forEach((function(e){return e({action:i,payload:u})}))}))}else window.dispatchEvent(new CustomEvent("__mfe_pubsub",{detail:{action:{type:r,sender:d,receiver:l},payload:u,appId:l}}))};window.addEventListener("__mfe_pubsub",(function(e){var n=e.detail,i=n.appId,t=n.action,r=n.payload;(o[i]||[]).forEach((function(e){return e({action:t,payload:r})}))})),window.addEventListener("message",(function(n){var o;if(n.origin===(null===(o=n.data)||void 0===o?void 0:o.senderOrigin))if(e())a=null==(r=n.data)?void 0:r.action,d=null==r?void 0:r.payload,window.dispatchEvent(new CustomEvent("__mfe_pubsub",{detail:{action:{type:a.type,sender:a.sender,receiver:a.receiver},payload:d,appId:a.receiver}}));else{console.log("from iframe child ",n);var r,a=null==(r=n.data)?void 0:r.action,d=null==r?void 0:r.payload;a&&"root"!==a.receiver?i({action:{receiver:a.receiver,type:a.type,sender:a.sender},payload:d,broadcast:r.broadcast,targetOrigin:r.targetOrigin||"*"}):a&&t({action:{type:a.type,sender:a.sender,receiver:a.receiver},payload:d,broadcast:null==r?void 0:r.broadcast})}else console.error("Invalid Origin")}));var r=function(e,o){n[e]?n[e]=Object.assign(Object.assign({},n[e]),o):n[e]=Object.assign({},o)};return{registerApplication:function(e,n){r(e,n)},setRootConfig:function(e,n){r(e,n)},mount:function(e,o,i){var t;null===(t=n[e])||void 0===t||t.mount(o,i)},unmount:function(e,o){var i;null===(i=n[e])||void 0===i||i.unmount(o)},getApplication:function(e){return n[e]},deRegisterApplication:function(e){n[e]={}},getRegistry:function(){return n},start:function(){!function(){var e=new URL(window.location).pathname;Object.keys(n).forEach((function(o){if(e.includes(n[o].activeWhen)){var i=document.createElement("mfe-application");i.setAttribute("app-id",o),i.setAttribute("app-name",n[o].name),i.setAttribute("id",n[o].id),i.setAttribute("style",n[o].styles),document.querySelector("div#mfe-application-"+o).appendChild(i)}}))}()},__mfe_publish:function(n){var o,r=void 0===n?{action:{type:"",sender:"",receiver:""},payload:null,broadcast:!1,targetOrigin:"",senderOrigin:window.origin}:n,a=r.action,d=a.type,c=void 0===d?"":d,l=a.sender,s=void 0===l?"":l,u=a.receiver,v=void 0===u?"":u,p=r.payload,f=void 0===p?null:p,g=r.broadcast,y=void 0!==g&&g,b=r.targetOrigin,w=void 0===b?"":b,m=r.senderOrigin,h=void 0===m?window.origin:m;e()?null===(o=window.top)||void 0===o||o.postMessage({action:{type:c,sender:s,receiver:v},payload:f,broadcast:y,senderOrigin:window.origin},w||"*"):(console.log("receiver ",v),"root"!==v?i({action:{receiver:v,type:c,sender:s},payload:f,broadcast:y,targetOrigin:w,senderOrigin:h}):null==t||t({action:{type:c,sender:s,receiver:v},payload:f,broadcast:y}))},__mfe_subscribe:function(e,n){var i=o[e]||[];i.push(n),o[e]=i},__mfe_unsubscribe:function(e,n){var i=o[e]||[],t=i.indexOf(n);t>=0&&i.splice(t,1)}}}();class o extends HTMLElement{constructor(){super(),this.addEventListener("click",(e=>{this.handler()})),n?.__mfe_subscribe?.("web12",(e=>{console.log(`msg from outside for web12 is ${e}`)}))}handler(){console.log("jdjdhjso "),n?.__mfe_publish?.({action:{type:"from_child webc",sender:"web12",receiver:"root"},payload:"from child webc",senderOrigin:window.origin,targetOrigin:"http://localhost:3333"})}connectedCallback(){this.innerHTML="<h1>Hello world</h1>\n        <button>publish event</button>\n      "}}customElements.define("my-component",o);const i=document.createElement("my-component"),t={mount:async(e,n)=>{e?(console.log("MOUNT: web12",e,n),e.appendChild(i)):console.warn("APP - web12 container not found")},unmount:e=>{console.log("UNMOUNT: web12"),e.remove(i)}};n?.setRootConfig?.("web12",t)}();