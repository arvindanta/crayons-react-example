{"version":3,"sources":["App.tsx","index.tsx"],"names":["APP_ID","inIframe","window","self","top","e","App","props","state","x","triggerClick","bind","broadCastMessage","addEventListener","message","console","log","setState","data","appId","__mfe_subscribe","msg","postMessage","action","type","sender","receiver","payload","__mfe_publish","broadcast","className","JSON","stringify","this","onClick","React","Component","mount","container","appProps","a","warn","ReactDOM","render","unmountComponentAtNode","onload","document","getElementById"],"mappings":"mSAKMA,EAAS,WACf,SAASC,IACP,IACE,OAAOC,OAAOC,OAASD,OAAOE,IAC9B,MAAOC,GACP,OAAO,G,IAiFIC,E,kDA7Eb,WAAYC,GAAa,IAAD,8BACtB,cAAMA,IACDC,MAAQ,CACXC,EAAG,KAEL,EAAKC,aAAe,EAAKA,aAAaC,KAAlB,gBACpB,EAAKC,iBAAmB,EAAKA,iBAAiBD,KAAtB,gBANF,E,qDASxB,WAAqB,IACF,IADC,OACbV,IAKHC,OAAOW,iBAAiB,WAAW,SAACC,GAClCC,QAAQC,IAAI,+BAAgCF,GAC5C,EAAKG,SAAS,CAAER,EAAGK,EAAQI,KAAKC,WANlC,QAAC,GAAD,EAACjB,QAAekB,uBAAhB,gBAAkCpB,GAAQ,SAACqB,GACzCN,QAAQC,IAAR,+BAAoChB,EAApC,eAAiDqB,S,0BAUvD,WAWU,IAAD,EATU,KADjBN,QAAQC,IAAI,SACPf,KAUH,UAAAC,OAAOE,WAAP,SAAYkB,YACV,CACEC,OAAQ,CACNC,KAAM,cACNC,OAAQ,WACRC,SAAU,SAEZC,QAAS,2CAEX,KAlBF,QAAC,GAAD,EAACzB,QAAe0B,qBAAhB,gBAAgC,CAC9BL,OAAQ,CACNC,KAAM,sBACNC,OAAQ,WACRC,SAAU,SAEZC,QAAS,0B,8BAiBf,WAEoB,IAAD,KADjBZ,QAAQC,IAAI,aACPf,OACH,QAAC,GAAD,EAACC,QAAe0B,qBAAhB,gBAAgC,CAC9BL,OAAQ,CACNC,KAAM,sBACNC,OAAQ,YAEVE,QAAS,gCACTE,WAAW,O,oBAKjB,WACE,OACE,sBAAKC,UAAU,MAAf,UACE,0CAAaC,KAAKC,UAAUC,KAAKzB,UACjC,wBAAQ0B,QAASD,KAAKvB,aAAtB,qCAEA,wBAAQwB,QAASD,KAAKrB,iBAAtB,uC,GArEUuB,IAAMC,WCTlBpC,EAAS,WAOfE,OAAM,SAAkBA,OAAM,UAAmB,GACjDA,OAAM,SAAgBmC,MAAtB,uCAA8B,WAAOC,EAAgBC,GAAvB,SAAAC,EAAA,yDACvBF,EADuB,uBAE1BvB,QAAQ0B,KAAR,gBAAsBzC,EAAtB,yBAF0B,iCAM5Be,QAAQC,IAAR,iBAAsBhB,GAAUsC,EAAWC,GAE3CG,IAASC,OAAO,cAAC,EAAD,eAASJ,IAAcD,GARX,gCAAAE,EAAA,MAUrB,sBAAAA,EAAA,sDACLzB,QAAQC,IAAR,mBAAwBhB,IACxB0C,IAASE,uBAAuBN,GAF3B,4CAVqB,2CAA9B,wDAgBAvB,QAAQC,IAAI,gBAAiBd,OAAM,UAEnCA,OAAO2C,OAAS,WACd3C,OAAM,SAAgBmC,MAAMS,SAASC,eAAe,QAAS,O","file":"static/js/main.7af458ed.chunk.js","sourcesContent":["// import Pattern1 from \"./formpattern/Pattern1\";\n// import Pattern2 from \"./formpattern/Pattern2\";\n// import Pattern3 from \"./formpattern/Pattern3\";\n// import Slot from \"./Slot\"\nimport React from \"react\";\nconst APP_ID = \"react121\";\nfunction inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\nclass App extends React.Component {\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      x: \"x\",\n    };\n    this.triggerClick = this.triggerClick.bind(this);\n    this.broadCastMessage = this.broadCastMessage.bind(this);\n  }\n\n  componentDidMount() {\n    if (!inIframe()) {\n      (window as any).__mfe_subscribe?.(APP_ID, (msg: any) => {\n        console.log(`msg from outside for ${APP_ID} is ${msg}`);\n      });\n    } else {\n      window.addEventListener(\"message\", (message: any) => {\n        console.log(\"message received from parent\", message);\n        this.setState({ x: message.data.appId });\n      });\n    }\n  }\n\n  triggerClick() {\n    console.log(\"click\");\n    if (!inIframe()) {\n      (window as any).__mfe_publish?.({\n        action: {\n          type: \"from_child react121\",\n          sender: \"react121\",\n          receiver: \"web12\",\n        },\n        payload: \"from child react121\",\n      });\n    } else {\n      window.top?.postMessage(\n        {\n          action: {\n            type: \"REACT121MSG\",\n            sender: \"react121\",\n            receiver: \"web12\",\n          },\n          payload: \"child sending message from iframe web12\",\n        },\n        \"*\"\n      );\n    }\n  }\n\n  broadCastMessage() {\n    console.log(\"broadcast\");\n    if (!inIframe()) {\n      (window as any).__mfe_publish?.({\n        action: {\n          type: \"from_child react121\",\n          sender: \"react121\",\n        },\n        payload: \"from child broadcast react121\",\n        broadcast: true,\n      });\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <h1>hello : {JSON.stringify(this.state)}</h1>\n        <button onClick={this.triggerClick}> Trigger pubsub publish</button>\n\n        <button onClick={this.broadCastMessage}> Trigger Broadcast</button>\n        {/* <Pattern2/> */}\n        {/* <Pattern3/> */}\n        {/* <Slot/> */}\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nconst APP_ID = \"react121\";\n\ndeclare global {\n  interface Window {\n    mount: (container: any, appProps: any) => void;\n  }\n}\nwindow[APP_ID as any] = window[APP_ID as any] || {};\nwindow[APP_ID as any].mount = async (container: any, appProps: any) => {\n  if (!container) {\n    console.warn(`APP - ${APP_ID} container not found`);\n    return;\n  }\n\n  console.log(`MOUNT: ${APP_ID}`, container, appProps);\n\n  ReactDOM.render(<App {...appProps} />, container);\n\n  return async () => {\n    console.log(`UNMOUNT: ${APP_ID}`);\n    ReactDOM.unmountComponentAtNode(container);\n  };\n};\n\nconsole.log(\"window appid \", window[APP_ID as any]);\n\nwindow.onload = () => {\n  window[APP_ID as any].mount(document.getElementById(\"root\"), {});\n};\n\n// ReactDOM.render(\n//   <React.StrictMode>\n//     <App />\n//   </React.StrictMode>,\n//   document.getElementById(\"root\")\n// )\n"],"sourceRoot":""}